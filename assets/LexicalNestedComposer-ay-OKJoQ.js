import{r as e,a8 as t,a9 as s,g as n,j as o}from"./index-BAeg54_S.js";function r(e){const t=e.transform();return null!==t?new Set([t]):new Set}function a({initialEditor:a,children:l,initialNodes:i,initialTheme:c,skipCollabChecks:p}){const f=e.useRef(!1),d=e.useContext(t);if(null==d)throw Error("Unexpected parent context null on a nested composer");const[u,{getTheme:h}]=d,m=e.useMemo((()=>{const e=c||h()||void 0,t=s(d,e);if(void 0!==e&&(a._config.theme=e),a._parentEditor=u,i)for(let s of i){let e=null,t=null;if("function"!=typeof s){const n=s;s=n.replace,e=n.with,t=n.withKlass||null}const n=a._nodes.get(s.getType());a._nodes.set(s.getType(),{exportDOM:n?n.exportDOM:void 0,klass:s,replace:e,replaceWithKlass:t,transforms:r(s)})}else{const e=a._nodes=new Map(u._nodes);for(const[t,s]of e)a._nodes.set(t,{exportDOM:s.exportDOM,klass:s.klass,replace:s.replace,replaceWithKlass:s.replaceWithKlass,transforms:r(s.klass)})}return a._config.namespace=u._config.namespace,a._editable=u._editable,[a,t]}),[]),{isCollabActive:_,yjsDocMap:g}=n(),x=p||f.current||g.has(a.getKey());return e.useEffect((()=>{x&&(f.current=!0)}),[x]),e.useEffect((()=>u.registerEditableListener((e=>{a.setEditable(e)}))),[a,u]),o.jsx(t.Provider,{value:m,children:!_||x?l:null})}export{a as L};
